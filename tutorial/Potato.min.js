!function(e){var t={};function i(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function a(e){var t={},i=[];return{add(a){if(t[a.id])throw new Error(`Sprite '${a.id}' exists.`);var r;return a.game={width:e.width,height:e.height},a.stage={width:e.stage.width,height:e.stage.height},t[a.id]=a,-1===i.indexOf(a.layer)&&(i.push(a.layer),i.sort()),r={},i.forEach((function(e){for(var i in t){var a=t[i];a.layer===e&&(r[a.id]=a,delete t[i])}})),t=r,a},del(i){var a=t[i];if(!a)throw new Error(`Unit ${i} doesn't exist`);a.beforeDestroy&&a.beforeDestroy(),delete e.userEvents[i],a.audio.clear(),delete t[i],a.destroyed&&a.destroyed()},clear(e){for(var i in t){var a=t[i];!e&&a.global||this.del(i)}},find:e=>t[e],filter(e){var i={};for(var a in t){var r=t[a];!0===e(r)&&(i[a]=r)}return i},travel(e){for(var i in t)if(!1===e(t[i]))break}}}i.r(t);var r={};function n(e,t){var i=r.userEvents;for(var a in i){var n=i[a];n[e]&&n[e](t)}}r.init=function(e){var t,i,o;this.canvas=document.getElementById(e.el),this.width=e.width,this.height=e.height,this.scale=this.canvas.clientHeight/this.height,this.mode=e.mode,this.key=null,this.userEvents={},this.animationInterval=e.animationInterval||16,this.test=!1,this.isMobile=(t="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase(),i=t&&t.indexOf("android")>0,o=t&&/iphone|ipad|ipod|ios/.test(t),!(!i&&!o)),this.imagePath=e.path?e.path.image:"",this.audioPath=e.path?e.path.audio:"",this.asset=function(e){var t=e.imagePath,i=e.audioPath,a=[],r={};return{allLoaded(e){a.length>0?Promise.all(a).then((function(){e()})):e()},get:(e,t)=>r[e][t],load(n){var o=n.type,d=n.group,h=n.name,l=n.url;if(r[d]||(r[d]={}),!r[d][h]){if("image"===o){var s=new Image;return a.push(new Promise((function(e){s.onload=function(){r[d][h]=s,e(!0)}}))),void(s.src=t+l)}if("animation"===o){s=new Image;return a.push(new Promise((function(t){s.onload=function(){switch(e.mode){case 0:r[d][h]={image:s,frame:n.frame,interval:n.interval,flip:n.flip};break;case 1:r[d][h]={image:s}}t(!0)}}))),void(s.src=t+l)}"audio"===o&&(r[d][h]=new Audio(i+l))}}}}(this),this.unit=a(this),this.mix=function(e,t){e.mixins||(e.mixins=[]),e.mixins.push(t)},this.canvas.setAttribute("width",this.width+"px"),this.canvas.setAttribute("height",this.height+"px");var d=window.addEventListener;d("keydown",(function(e){e.stopPropagation(),e.preventDefault();var t=e.key;r.key!==t&&(r.key=t,n("keydown",t))})),d("keyup",(function(e){e.stopPropagation(),e.preventDefault();var t=e.key;r.key===t&&(r.key=null),n("keyup",t)})),["mousedown","mouseup"].forEach((function(e){d(e,(function(t){t.stopPropagation(),t.preventDefault(),r.isMobile||n(e,function(e){var t=r.canvas,i=r.scale;return{x:(e.clientX-t.offsetLeft)/i,y:(e.clientY-t.offsetTop)/i,button:e.button}}(t))}))})),["touchstart","touchmove","touchend"].forEach((function(e){d(e,(function(t){n(e,function(e){for(var t=r.canvas,i=r.scale,a=[],n=0;n<e.targetTouches.length;n++){var o=e.targetTouches[n];a.push({x:(o.clientX-t.offsetLeft)/i,y:(o.clientY-t.offsetTop)/i,id:o.identifier,type:e.type})}return a}(t))}))})),window.oncontextmenu=function(){return!1}};var o=r;function d(e){var t={x:0,y:0,scale:1,follow:null,movement:null},i=function(i,a,r,n,d=!0){var h=60*r||1,l=i/h,s=a/h;if(0!==l||0!==s){t.follow=null;var u=e.width,f=e.height,c=o.width,v=o.height,g=0;!0===d&&o.unit.travel((function(e){e.disabled=!0})),t.movement=function(){if(t.x+=l,t.y+=s,++g>h||t.x<0||t.x>u-c||t.y<0||t.y>f-v)return t.x=Math.max(0,t.x),t.x=Math.min(t.x,u-c),t.y=Math.max(0,t.y),t.y=Math.min(t.y,f-v),t.movement=null,!0===d&&o.unit.travel((function(e){e.disabled=!1})),void(n&&n())}}};function a(t){var i=t.x,a=t.y,r=t.width,n=t.height,d=e.width,h=e.height,l=o.width,s=o.height;return{x:i<(l-r)/2?0:i>d-(l+r)/2?d-l:i-(l-r)/2,y:a<(s-n)/2?0:a>h-(s+n)/2?h-s:a-(s-n)/2}}return{follow(e){e!==t.follow&&(t.follow=e)},update:()=>(function(){var e=t.follow;if(e){var i=a(e);t.x=i.x,t.y=i.y}else t.movement&&t.movement()}(),t),move(e,t,a,r){i(e,t,a,r)},moveTo(e,r,n){var{x:o,y:d}=a(e);i(o-t.x,d-t.y,r,n)},unFollow(){t.follow=null}}}var h=function e(t){var i=this;o.asset.allLoaded((function(){o.stage&&o.stage.execute.destory(),i.beforeCreate=t.beforeCreate,i.created=t.created,i.beforeUpdate=t.beforeUpdate,i.updated=t.updated,i.beforeDestroy=t.beforeDestroy,i.destoryed=t.destoryed,i.beforeCreate&&i.beforeCreate(),o.key=null,o.stage=i;var a=t.config;i.width=a&&a.width||o.width,i.height=a&&a.height||o.height,i.camera=d(i),i.event=function(e){var t={};return{add(i,a,...r){t[i]&&reutrn,t[i]=a.bind(e,...r)},del(e){t[e]&&delete t[e]},execute(){for(var i in t)t[i].call(e)}}}(i),i.geometry=function(){function e(e,t){return{x1:e.x,y1:e.y,w1:e.width,h1:e.height,x2:t.x,y2:t.y,w2:t.width,h2:t.height}}return{above(t,i){var{x1:a,y1:r,w1:n,h1:o,x2:d,y2:h,w2:l}=e(t,i);return r+o<=h&&a+n>=d&&a<=d+l},contain(t,i){var{x1:a,y1:r,w1:n,h1:o,x2:d,y2:h,w2:l,h2:s}=e(t,i);return!(n<l&&o<s&&(a<=d||a+n>=d+l)&&(r<=h||r+o>=h+s))},distance(t,i,a){var{x1:r,y1:n,w1:o,h1:d,x2:h,y2:l,w2:s,h2:u}=e(i,a);if("y"===t)return l>n+d?l-(n+d):n>l+u?n-(l+u):0;if("x"===t)return h>r+o?h-(r+o):r>h+s?r-(h+s):0;if("o"===t){var f=[r+o/2,n+d/2],c=[h+s/2,l+u/2];return Math.sqrt((f[0]-c[0])**2+(f[1]-c[1])**2)}},intersect(t,i){var{x1:a,y1:r,w1:n,h1:o,x2:d,y2:h,w2:l,h2:s}=e(t,i);return!(a>=d+l||a+n<=d||r>=h+s||r+o<=h)},onRight(t,i){var{x1:a,y1:r,h1:n,x2:o,y2:d,w2:h,h2:l}=e(t,i);return a>=o+h&&r+n>=d&&r<=d+l},onLeft(t,i){var{x1:a,y1:r,w1:n,h1:o,x2:d,y2:h,h2:l}=e(t,i);return a+n<=d&&r+o>=h&&r<=h+l},tangent(t,i){var{x1:a,y1:r,w1:n,h1:o,x2:d,y2:h,w2:l,h2:s}=e(t,i);return!(a>d+l||a+n<d||r>h+s||r+o<h)},under(t,i){var{x1:a,y1:r,w1:n,x2:o,y2:d,w2:h,h2:l}=e(t,i);return r>=d+l&&a+n>=o&&a<=o+h}}}(),i.execute=function(e){var t=o.canvas.getContext("2d"),i=!1;function a(){if(!i){e.beforeUpdate&&e.beforeUpdate();var r=e.camera.update();e.event.execute(),t.clearRect(0,0,o.width,o.height),o.unit.travel((function(e){!function(e,t){e.beforeUpdate&&e.beforeUpdate(),e.relX=e.x-t.x*(1-e.fixed),e.relY=e.y-t.y*(1-e.fixed),e.audio.update(),e.graphics.render(),e.event.execute(),e.updated&&e.updated()}(e,r)})),e.updated&&e.updated(),window.requestAnimationFrame(a)}}return{destory(){e.beforeDestroy&&e.beforeDestroy(),i=!0,o.unit.clear(),e.destoryed&&e.destoryed()},loop(){a()}}}(i),e.mixins&&e.mixins.forEach((function(e){e.call(i)})),i.created&&i.created.call(i),i.execute.loop()}))};function l(e){var t=o.canvas.getContext("2d"),i=Math.floor,a=null,r=function(t,i,a){e.drawWidth=t,e.drawHeight=i,a&&(e.width=t,e.height=i)},n=function(){return{relX:e.relX,relY:e.relY,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,width:e.width,height:e.height,drawWidth:e.drawWidth,drawHeight:e.drawHeight,scale:e.scale,direction:e.direction}},d=function(e){var{relX:a,relY:r,offsetLeft:d,offsetTop:l,width:s,drawWidth:u,drawHeight:f,scale:c,direction:v}=n();if("right"===v){var g=i(a+d),w=i(r+l);t.drawImage(e,0,0,u,f,g,w,u*c,f*c)}else{g=i(o.width-s*c-a+d),w=i(r+l);h(o.width,(function(){t.drawImage(e,0,0,u,f,g,w,u*c,f*c)}))}};function h(e,i){t.translate(e,0),t.scale(-1,1),i(),t.translate(e,0),t.scale(-1,1)}return{animation(d,l,s=!1){var u=o.asset.get(d,l);if(0===o.mode){r(u.image.width/u.frame,u.image.height,s);var f={animationFrames:u.frame,animationInterval:u.interval||o.animationInterval,width:e.drawWidth,height:e.drawHeight,flip:u.flip,onComplete:null}}else{r(u.image.width/4,u.image.height/4,s);f={animationFrames:4,animationInterval:u.interval||o.animationInterval,width:e.drawWidth,height:e.drawHeight,onComplete:null,play(){g=!0},stop(){g=!1,v=0}}}var c=0,v=0,g=0===o.mode;return a=function(){!function(e,a,r){var{relX:d,relY:l,offsetLeft:s,offsetTop:u,width:f,drawWidth:c,drawHeight:v,scale:g,direction:w}=n();if(0===o.mode)if(!r&&"right"===w||r&&"left"===w){var m=i(d+s),p=i(l+u);t.drawImage(e,a*c,0,c,v,m,p,c*g,v*g)}else{m=i(o.width-f*g-d+s),p=i(l+u);h(o.width,(function(){t.drawImage(e,a*c,0,c,v,m,p,c*g,v*g)}))}else{m=i(d+s),p=i(l+u);switch(w){case"down":t.drawImage(e,a*c,0,c,v,m,p,c*g,v*g);break;case"left":t.drawImage(e,a*c,v,c,v,m,p,c*g,v*g);break;case"right":t.drawImage(e,a*c,2*v,c,v,m,p,c*g,v*g);break;case"up":t.drawImage(e,a*c,3*v,c,v,m,p,c*g,v*g)}}}(u.image,v,f.flip),g&&++c>=f.animationInterval&&(c=0,++v>=f.animationFrames&&(v=0,f.onComplete&&f.onComplete.call(this)))},e.animation=f,f},clear(){a=null},draw(i){a=function(){i.call(e,t)}},image(e,t,i=!1){var n=o.asset.get(e,t);r(n.width,n.height,i),a=function(){d(n)}},mix(e,i){var r=o.canvas.cloneNode(),n=r.getContext("2d"),d=new Image;"static"===e?(n.clearRect(0,0,o.width,o.height),i(n),d.src=r.toDataURL("image/png"),a=function(){t.drawImage(d,0,0)}):"dynamic"===e&&(a=function(){n.clearRect(0,0,o.width,o.height),i(n),d.src=r.toDataURL("image/png"),t.drawImage(d,0,0)})},particle(t,i,r,n,h){var l,s,u=o.asset.get(t,i);e.width=0,e.height=0,e.drawWidth=u.width,e.drawHeight=u.height,n&&(l=(n[1]-n[0])/r),h&&(s=(h[1]-h[0])/r,e.scale=h[1]),a=function(){null!=l&&((e.alpha+l<=n[0]||e.alpha+l>=n[1])&&(l=-l),e.alpha+=l),null!=s&&((e.scale+s<=h[0]||e.scale+s>=h[1])&&(s=-s),e.scale+=s),d(u)}},render(){var i=o.width,r=o.height,n=e.relX,d=e.relY,h=e.width,l=e.height,s=e.scale;n+h*s<0||n>i||d+l*s<0||d>r||(t.globalAlpha=e.alpha,a&&a(),o.test&&(t.strokeStyle="red",t.strokeRect(e.relX,e.relY,e.width,e.height)))}}}var s=function e(t){this.beforeCreate=t.beforeCreate,this.created=t.created,this.beforeUpdate=t.beforeUpdate,this.updated=t.updated,this.beforeDestroy=t.beforeDestroy,this.destroyed=t.destroyed,this.beforeCreate&&this.beforeCreate();var i=t.config;if(!i.id)throw Error("Sprite need an id.");if(this.id=i.id,this.x=i.x||0,this.y=i.y||0,this.width=i.width||0,this.height=i.height||0,this.offsetLeft=i.offsetLeft||0,this.offsetTop=i.offsetTop||0,this.global=i.global||!1,this.alpha=null==i.alpha?1:i.alpha,this.scale=null==i.scale?1:i.scale,this.direction=i.direction||"right",this.layer=i.layer||0,this.disabled=i.disabled||!1,this.fixed=i.fixed||0,null==this.id)throw new Error("Sprite needs an id.");if(this.id instanceof Number||!isNaN(Number(this.id)))throw new Error("Sprite must start with a letter.");for(var a in t.data)this[a]=t.data[a];for(var a in t.methods)this[a]=t.methods[a];if(this.graphics=l(this),this.audio=function(e){var t={audio:null},i=[];return{update(){if(t.audio||0!==i.length){var a=e.relX,r=e.relY,n=Math.sqrt(a**2+r**2);if(t.audio&&t.range>0){var o=t.range;s(h=t.audio,o,t.defalutVolume,n)}for(var d=0;d<i.length;d++){var h,l=i[d];o=l.range;!0!==(h=l.audio).ended?s(h,o,l.defalutVolume,n):(i.splice(d,1),h.remove(),d--)}}function s(e,t,i,a){t&&(e.volume=a>=t?0:i*((t-a)/t))}},play(e){var a=e.type,r=e.group,n=e.name,d=e.range||0,h=e.volume||1,l=e.startTime||0,s=e.loop||!0,u=o.asset.get(r,n);if("sound"===a){var f=u.cloneNode();return f.volume=h,f.currentTime=l,f.play(),void i.push({audio:f,defalutVolume:h,range:d})}"music"===a&&(t.audio!==u&&(t.audio=u,t.defalutVolume=h,t.range=d,u.currentTime=l,u.volume=h,u.loop=s),u.play())},stop(){t.pause(),t.currentTime=0},clear(){t.audio&&t.audio.remove(),i.forEach((function(e){e.audio.remove()}))}}}(this),this.event=function(e){var t={};return{add(e,i){t[e]||(t[e]=i)},del(e){t[e]&&delete t[e]},delAll(){t={}},execute(){if(!e.disabled)for(var i in t)t[i].call(e)}}}(this),this.userEvent=function(e){var t=o.userEvents;return{watch(i,a){t[e.id]||(t[e.id]={}),t[e.id][i]=a.bind(e)},unwatch(i){i&&t[e.id]&&t[e.id][i]&&delete o.userEvents[e.id][i]}}}(this),e.mixins){var r=this;e.mixins.forEach((function(e){e.call(r)}))}o.unit.add(this),t.created&&t.created.call(this)};console.log("Potato | version:0.6.0 | author:Roanne");window.Potato={Game:o,Stage:h,Sprite:s}}]);