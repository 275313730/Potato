!function(e){var t={};function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function r(e){var t={},i=[];return{add(r){if(t[r.id])throw new Error(`Sprite '${r.id}' exists.`);var a;return r.game={width:e.width,height:e.height},r.stage={width:e.stage.width,height:e.stage.height},t[r.id]=r,-1===i.indexOf(r.layer)&&(i.push(r.layer),i.sort()),a={},i.forEach((function(e){for(var i in t){var r=t[i];r.layer===e&&(a[r.id]=r,delete t[i])}})),t=a,r},del(i){var r=t[i];if(!r)throw new Error(`Unit ${i} doesn't exist`);r.beforeDestroy&&r.beforeDestroy(),delete e.userEvents[i],r.audio.delAll(),delete t[i],r.destroyed&&r.destroyed()},delAll(e){for(var i in t){var r=t[i];!e&&r.global||this.del(i)}},find:e=>t[e],filter(e){var i={};for(var r in t){var a=t[r];!0===e(a)&&(i[r]=a)}return i},travel(e){for(var i in t)if(!1===e(t[i]))break}}}i.r(t);var a={};function n(e,t){var i=a.userEvents;for(var r in i){var n=i[r];n[e]&&n[e](t)}}a.init=function(e){var t,i,o;this.canvas=document.getElementById(e.el),this.width=e.width,this.height=e.height,this.scale=this.canvas.clientHeight/this.width,this.key=null,this.userEvents={},this.animationInterval=e.animationInterval||16,this.test=!1,this.isMobile=(t="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase(),i=t&&t.indexOf("android")>0,o=t&&/iphone|ipad|ipod|ios/.test(t),!(!i&&!o)),this.imagePath=e.path?e.path.image:"",this.audioPath=e.path?e.path.audio:"",this.asset=function(e){var t=e.imagePath,i=e.audioPath,r=[],a={};return{allLoaded(e){r.length>0?Promise.all(r).then((function(){e()})):e()},get:(e,t)=>a[e][t],load(e){var n=e.type,o=e.group,d=e.name,h=e.url;if(a[o]||(a[o]={}),!a[o][d]){if("image"===n){var l=new Image;return r.push(new Promise((function(e){l.onload=function(){a[o][d]=l,e(!0)}}))),void(l.src=t+h)}if("animation"===n){l=new Image;return r.push(new Promise((function(t){l.onload=function(){a[o][d]={image:l,width:e.width,interval:e.interval,flip:e.flip},t(!0)}}))),void(l.src=t+h)}"audio"===n&&(a[o][d]=new Audio(i+h))}}}}(this),this.unit=r(this),this.mix=function(e,t){e.mixins||(e.mixins=[]),e.mixins.push(t)},this.canvas.setAttribute("width",this.width+"px"),this.canvas.setAttribute("height",this.height+"px");var d=window.addEventListener;d("keydown",(function(e){e.stopPropagation(),e.preventDefault();var t=e.key;a.key!==t&&(a.key=t,n("keydown",t))})),d("keyup",(function(e){e.stopPropagation(),e.preventDefault();var t=e.key;a.key===t&&(a.key=null),n("keyup",t)})),["mousedown","mouseup"].forEach((function(e){d(e,(function(t){t.stopPropagation(),t.preventDefault(),a.isMobile||n(e,function(e){var t=a.canvas,i=a.scale;return{x:(e.clientX-t.offsetLeft)/i,y:(e.clientY-t.offsetTop)/i,button:e.button}}(t))}))})),["touchstart","touchmove","touchend"].forEach((function(e){d(e,(function(t){n(e,function(e){for(var t=a.canvas,i=a.scale,r=[],n=0;n<e.targetTouches.length;n++){var o=e.targetTouches[n];r.push({x:(o.clientX-t.offsetLeft)/i,y:(o.clientY-t.offsetTop)/i,id:o.identifier,type:e.type})}return r}(t))}))})),window.oncontextmenu=function(){return!1}};var o=a;function d(e){var t={x:0,y:0,scale:1,follow:null,movement:null},i=function(i,r,a,n,d=!0){var h=a*o.frames||1,l=i/h,s=r/h;if(0!==l||0!==s){t.follow=null;var u=e.width,f=o.width;t.x<0&&(t.x=0),t.x>u-f&&(t.x=u-f);var c=0;!0===d&&o.unit.travel((function(e){e.disabled=!0})),t.movement=function(){if(t.x+=l,t.y+=s,++c>h||t.x<=0||t.x>=u-f)return t.movement=null,!0===d&&o.unit.travel((function(e){e.disabled=!1})),void(n&&n())}}};function r(t){var i=t.x,r=t.y,a=t.width,n=t.height,d=e.width,h=e.height,l=o.width,s=o.height;return{x:i<(l-a)/2?0:i>d-(l+a)/2?d-l:i-(l-a)/2,y:r<(s-n)/2?0:r>h-(s+n)/2?h-s:r-(s-n)/2}}return{follow(e){e!==t.follow&&(t.follow=e)},update:()=>(function(){var e=t.follow;if(e){var i=r(e);t.x=i.x,t.y=i.y}else t.movement&&t.movement()}(),t),move(e,t,r,a){i(e,t,r,a)},moveTo(e,a,n){var{x:o,y:d}=r(e);i(o-t.x,d-t.y,a,n)},unFollow(){t.follow=null}}}var h=function e(t){var i=this;o.asset.allLoaded((function(){o.stage&&o.stage.execute.destory(),i.beforeCreate=t.beforeCreate,i.created=t.created,i.beforeUpdate=t.beforeUpdate,i.updated=t.updated,i.beforeDestroy=t.beforeDestroy,i.destoryed=t.destoryed,i.beforeCreate&&i.beforeCreate(),o.key=null,o.stage=i;var r=t.config;i.width=r&&r.width||o.width,i.height=r&&r.height||o.height,i.camera=d(i),i.event=function(e){var t={};return{add(i,r,...a){t[i]&&reutrn,t[i]=r.bind(e,...a)},del(e){t[e]&&delete t[e]},execute(){for(var i in t)t[i].call(e)}}}(i),i.geometry=function(){function e(e,t){return{x1:e.x,y1:e.y,w1:e.width,h1:e.height,x2:t.x,y2:t.y,w2:t.width,h2:t.height}}return{above(t,i){var{x1:r,y1:a,w1:n,h1:o,x2:d,y2:h,w2:l}=e(t,i);return a+o<=h&&r+n>=d&&r<=d+l},contain(t,i){var{x1:r,y1:a,w1:n,h1:o,x2:d,y2:h,w2:l,h2:s}=e(t,i);return!(n<l&&o<s&&(r<=d||r+n>=d+l)&&(a<=h||a+o>=h+s))},distance(t,i,r){var{x1:a,y1:n,w1:o,h1:d,x2:h,y2:l,w2:s,h2:u}=e(i,r);return"y"===t?l>n+d?l-(n+d):n>l+u?n-(l+u):0:"x"===t?h>a+o?h-(a+o):a>h+s?a-(h+s):0:void 0},intersect(t,i){var{x1:r,y1:a,w1:n,h1:o,x2:d,y2:h,w2:l,h2:s}=e(t,i);return!(r>=d+l||r+n<=d||a>=h+s||a+o<=h)},onRight(t,i){var{x1:r,y1:a,h1:n,x2:o,y2:d,w2:h,h2:l}=e(t,i);return r>=o+h&&a+n>=d&&a<=d+l},onLeft(t,i){var{x1:r,y1:a,w1:n,h1:o,x2:d,y2:h,h2:l}=e(t,i);return r+n<=d&&a+o>=h&&a<=h+l},tangent(t,i){var{x1:r,y1:a,w1:n,h1:o,x2:d,y2:h,w2:l,h2:s}=e(t,i);return!(r>d+l||r+n<d||a>h+s||a+o<h)},under(t,i){var{x1:r,y1:a,w1:n,x2:o,y2:d,w2:h,h2:l}=e(t,i);return a>=d+l&&r+n>=o&&r<=o+h}}}(),i.execute=function(e){var t=o.canvas.getContext("2d"),i=!1;function r(){if(!i){e.beforeUpdate&&e.beforeUpdate();var a=e.camera.update();e.event.execute(),t.clearRect(0,0,o.width,o.height),o.unit.travel((function(e){!function(e,t){e.beforeUpdate&&e.beforeUpdate(),e.relX=e.x-t.x*(1-e.fixed),e.relY=e.y-t.y*(1-e.fixed),e.audio.update(),e.graphics.render(),e.event.execute(),e.updated&&e.updated()}(e,a)})),e.updated&&e.updated(),window.requestAnimationFrame(r)}}return{destory(){e.beforeDestroy&&e.beforeDestroy(),i=!0,o.unit.delAll(),e.destoryed&&e.destoryed()},loop(){r()}}}(i),e.mixins&&e.mixins.forEach((function(e){e.call(i)})),i.created&&i.created.call(i),i.execute.loop()}))};function l(e){var t=o.canvas.getContext("2d"),i=Math.floor,r=null,a=function(t,i,r){e.drawWidth=t,e.drawHeight=i,r&&(e.width=t,e.height=i)},n=function(){return{relX:e.relX,relY:e.relY,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,width:e.width,drawWidth:e.drawWidth,drawHeight:e.drawHeight,scale:e.scale,direction:e.direction}},d=function(e){var{relX:r,relY:a,offsetLeft:d,offsetTop:l,width:s,drawWidth:u,drawHeight:f,scale:c,direction:v}=n();if("right"===v){var w=i(r+d),g=i(a+l);t.drawImage(e,0,0,u,f,w,g,u*c,f*c)}else{w=i(o.width-s-r+d),g=i(a+l);h(o.width,(function(){t.drawImage(e,0,0,u,f,w,g,u*c,f*c)}))}};function h(e,i){t.translate(e,0),t.scale(-1,1),i(),t.translate(e,0),t.scale(-1,1)}return{animation(e,d,l=!1){var s=o.asset.get(e,d);a(s.width,s.image.height,l);var u=0,f=0,c={animationFrames:s.image.width/s.width-1,animationInterval:s.interval||o.animationInterval,width:s.width,height:s.image.height,flip:s.flip,onComplete:null};return r=function(){!function(e,r,a){var{relX:d,relY:l,offsetLeft:s,offsetTop:u,width:f,drawWidth:c,drawHeight:v,scale:w,direction:g}=n();if(!r&&"right"===g||r&&"left"===g){var p=i(d+s),m=i(l+u);t.drawImage(e,a*c,0,c,v,p,m,c*w,v*w)}else{p=i(o.width-f*w-d+s),m=i(l+u);h(o.width,(function(){t.drawImage(e,a*c,0,c,v,p,m,c*w,v*w)}))}}(s.image,c.flip,f),++u>=c.animationInterval&&(u=0,++f>=c.animationFrames&&(f=0,c.onComplete&&c.onComplete.call(this)))},c},clear(){r=null},draw(i){r=function(){i.call(e,t)}},image(e,t,i=!1){var n=o.asset.get(e,t);a(n.width,n.height,i),r=function(){d(n)}},mix(e,i){var a=o.canvas.cloneNode(),n=a.getContext("2d"),d=new Image;"static"===e?(n.clearRect(0,0,o.width,o.height),i(n),d.src=a.toDataURL("image/png"),r=function(){t.drawImage(d,0,0)}):"dynamic"===e&&(r=function(){n.clearRect(0,0,o.width,o.height),i(n),d.src=a.toDataURL("image/png"),t.drawImage(d,0,0)})},particle(t,i,a,n,h){var l,s,u=o.asset.get(t,i);e.width=0,e.height=0,e.drawWidth=u.width,e.drawHeight=u.height,n&&(l=(n[1]-n[0])/a),h&&(s=(h[1]-h[0])/a,e.scale=h[1]),r=function(){null!=l&&((e.alpha+l<=n[0]||e.alpha+l>=n[1])&&(l=-l),e.alpha+=l),null!=s&&((e.scale+s<=h[0]||e.scale+s>=h[1])&&(s=-s),e.scale+=s),d(u)}},render(){var i=o.width,a=o.height,n=e.relX,d=e.relY,h=e.width,l=e.height,s=e.scale;n+h*s<0||n>i||d+l*s<0||d>a||(t.globalAlpha=e.alpha,r&&r(),o.test&&(t.strokeStyle="red",t.strokeRect(e.relX,e.relY,e.width,e.height)))}}}var s=function e(t){this.beforeCreate=t.beforeCreate,this.created=t.created,this.beforeUpdate=t.beforeUpdate,this.updated=t.updated,this.beforeDestroy=t.beforeDestroy,this.destroyed=t.destroyed,this.beforeCreate&&this.beforeCreate();var i,r,a,n=t.config;if(!n.id)throw Error("Sprite need an id.");if(this.id=n.id,this.x=n.x||0,this.y=n.y||0,this.width=n.width||0,this.height=n.height||0,this.offsetLeft=n.offsetLeft||0,this.offsetTop=n.offsetTop||0,this.global=n.global||!1,this.alpha=null==n.alpha?1:n.alpha,this.scale=null==n.scale?1:n.scale,this.direction=n.direction||"right",this.layer=n.layer||0,this.disabled=n.disabled||!1,this.fixed=n.fixed||0,null==this.id)throw new Error("Sprite needs an id.");if(this.id instanceof Number||!isNaN(Number(this.id)))throw new Error("Sprite must start with a letter.");for(var d in t.data)this[d]=t.data[d];for(var d in t.methods)this[d]=t.methods[d];this.graphics=l(this),this.audio=(i=this,r={audio:null},a=[],{update(){if(r.audio||0!==a.length){var e=i.relX,t=i.relY,n=Math.sqrt(e**2+t**2);if(r.audio&&r.range>0){var o=r.range;s(h=r.audio,o,r.defalutVolume,n)}for(var d=0;d<a.length;d++){var h,l=a[d];o=l.range,!0!==(h=l.audio).ended?s(h,o,l.defalutVolume,n):(a.splice(d,1),h.remove(),d--)}}function s(e,t,i,r){t&&(e.volume=r>=t?0:i*((t-r)/t))}},play(e){var t=e.type,i=e.group,n=e.name,d=e.range||0,h=e.volume||1,l=e.startTime||0,s=e.loop||!0,u=o.asset.get(i,n);if("sound"===t){var f=u.cloneNode();return f.volume=h,f.currentTime=l,f.play(),void a.push({audio:f,defalutVolume:h,range:d})}"music"===t&&(r.audio!==u&&(r.audio=u,r.defalutVolume=h,r.range=d,u.currentTime=l,u.volume=h,u.loop=s),u.play())},stop(){r.pause(),r.currentTime=0},clear(){r.audio&&r.audio.remove(),a.forEach((function(e){e.audio.remove()}))}}),this.event=function(e){var t={};return{add(e,i){t[e]||(t[e]=i)},del(e){t[e]&&delete t[e]},delAll(){t={}},execute(){if(!e.disabled)for(var i in t)t[i].call(e)}}}(this),this.userEvent=function(e){var t=o.userEvents;return{watch(i,r){t[e.id]||(t[e.id]={}),t[e.id][i]=r.bind(e)},unwatch(i){i&&t[e.id]&&t[e.id][i]&&delete o.userEvents[e.id][i]}}}(this),e.mixins&&e.mixins.forEach((function(e){e.call(this)})),o.unit.add(this),t.created&&t.created.call(this)};console.log("Potato | version:0.5.0 | author:Roanne");window.Potato={Game:o,Stage:h,Sprite:s}}]);